#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
#       CONFIGURATION VARIABLES
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
#  Currently available macros (cppdefs) are:
#  INCLUDE_PELFE                          : use Iron component to the pelagic system
#  INCLUDE_PELCO2, INCLUDE_BENCO2         : activate Carbonate System 
#  INCLUDE_BEN, INCLUDE_BENPROFILES       : Add Benthic compartment
#  INCLUDE_SILT                           : use Silt component
#  INCLUDE_SEAICE                         : activate SeaIce Ecology 
#  INCLUDE_DIAG3D, INCLUDE_DIAG2D         : additional diagnostics available for output
#  BFM_PARALLEL                           : used to run BFM with MPP

#  Warnings
# 1. Still not working for benthic BFM don't use DIAG with D1SOURCE and ONESOURCE
# 2. Using the key DEBUG will add more output information

&BFM_conf
        MODE    = 'NEMO',
        CPPDEFS = '-DINCLUDE_PELCO2 -DINCLUDE_DIAG3D',
        ARCH    = 'openmpif90_osx',
        PROC    = 4,
        EXP     = 'gyre_bfm',
        QUEUE   = 'poe_short',
/
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
#       CONFIGURATION VARIABLES
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

1d-variable
  dummy
  LocalDelta
end

1d-intvar
  InitializeModel
  idummy
end
	
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
#       Dimensional variables
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
3d-variable
  Depth : Gridpoint Depth: m
  Volume: Gridpoint Volume: m3
  Area  : Gridpoint Area: m2
end
2d-variable
  Area2d  : 2-D Gridpoint Area: m2
end

#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
#       Physical variables
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
3d-variable
  ETW   : temperature : C
  ESW   : Salinity : --
  ERHO  : Seawater Density : kg/m3
  EIR   : Irradiance : uE/m2/s
  ESS   : Suspended sediment : g/m3
end

2d-variable
  EWIND : 2D Wind speed : m/s
  EICE  : 2D Sea-ice fraction: -
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Phys forcing : Bottom stress near bottom 
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  ETAUB  : 2D Bottom Stress : N m/s
end

3d-state -if-exist INCLUDE_SILT
    R9x : Suspended sediment : mg/m3
end	

#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
#	Oxygen variables
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
3d-state
 O2o : Oxygen : mmol O2/m3
end

3d-variable
    cxoO2 :  Temperature-dependent oxygen saturation : mmol O2/m3
    XO2o :  Net O2 conc. = O2 - H2S  :mmol O2/m3
    eO2mO2                 : Relative Oxygen saturation: - 
end

#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
#       CO2 and Carbonate system variables
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2d-variable -if-exist INCLUDE_PELCO2
  EPCO2air   : atmospheric CO2 partial pressure : uatm
  CO2airflux : atm-ocean CO2 fluxes : mmol/m2/d
end

3d-variable -if-exist INCLUDE_PELCO2
    DIC        : Dissolved Inorganic Carbon : umol/kg
    CO2        : CO2(aq) : umol/kg
    pCO2       : Oceanic pCO2 : uatm
    HCO3       : Bicarbonate :  umol/kg
    CO3        : Carbonate : umol/kg
    Ac         : Alkalinity : umol eq/kg
    pH         : pH : -
    OCalc      : Saturation state of Calcite : -
    OArag      : Saturation state of Aragonite : -
    EPR        : Water Pressure : dbar
end

3d-state -if-exist INCLUDE_PELCO2
  group Inorganic[ch]: mg C/m3 : mmol eq/m3
     O3: Dissolved Inorganic Carbon: Alkalinity 
  end
end

2d-state  -if-exist INCLUDE_BENCO2
    group BenthicCO2[ch]:mgC/m2:mmol eq/m2
          G3  : TCO2 in aerobic layer  : alkalinity in aerobic layer 
          G13 : TCO2 in denitrification layer: alkalinity in denitrification layer  
          G23 : TCO2 in anaerobic layer: alkalinity in anaerobic layer  
    end
end

2d-variable -if-exist INCLUDE_BENCO2
      DICae :DIC in aerobic sediment (pore-waters)pore-waters: umol/kg
      DICan :concentration in anaerobic sediment (pore-waters): umol/kg
      O3c_Ben    : DIC at the pelagic-benthic interface :mg C/m3
      O3h_Ben    : alkalinity at the pelagic-benthic interface :mmol eq/m3
      Acae : Alkalinity in aerobic sediment : umol eq/kg
      Acan :  Alkalinity in anaerobic sediment : umol eq/kg
      pHae : pH in aerobic layer : -
      pHan : pH in anaerobic layer : -
      pCO2ae : CO2 partial pressure in aerobic layer : uatm
      pCO2an : CO2 partial pressure in anaerobic layer : uatm
end

2d-intvar -if-exist INCLUDE_BENCO2
    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    # Profile sequence numbers needed in benthic model
    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
      KCO2
      KALK
end

3d-state
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #	State Variable(s) for Nutrients
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

   N1p	:	Phosphate : mmol P/m3
   N3n	:	Nitrate  : mmol N/m3
   N4n	:	Ammonium : mmol N/m3
   O4n	:	NitrogenSink : mmol N/m3
   N5s	:	Silicate     : mmol Si/m3
   N6r	:	Reduction Equivalents : mmol S--/m3

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #	State Variable(s) for Bacteria
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

   B1[cnp]	: Pelagic Bacteria : mg C/m3 : mmol N/m3 : mmol P/m3

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #	State Variable(s) for Phytoplankton Species
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

   group PhytoPlankton[cnpls] :  mg C/m3 : mmol N/m3 : mmol P/m3 : mg Chl/m3 : mmol Si/m3
	P1	: Diatoms
	P2[-s]	: Flagellates
	P3[-s]	: PicoPhytoPlankton
	P4[-s]	: Dinoflagellates
   end
               
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #	State Variable(s) for Mesozooplankton
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

   group MesoZooPlankton[cnp] : mg C/m3 : mmol N/m3 : mmol P/m3
		Z3 	: Carnivorous mesozooplankton
		Z4 	: Omnivorous mesozooplankton
   end

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #	State Variable(s) for Microzooplankton
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 
   group MicroZooPlankton[cnp] : mg C/m3 : mmol N/m3 : mmol P/m3
		Z5	: Microzooplankton
		Z6	: Heterotrophic nanoflagellates (HNAN)
   end

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #	State Variable(s) for Detritus (Biogenic Organic Material)
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

    group PelDetritus[cnps] : mg C/m3 : mmol N/m3: mmol P/m3: mmol Si/m3
      R1[-s]    : Labile Dissolved Organic Matter
      R2[-nps]  : TEP (long carbohydrates)
      R6        : Particulate Organic Matter 
      R7[-nps]  : Refractory Organic Matter
    end
end

3d-variable

    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    # Variables to check totmass of C N P Si in pelagic
    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    totpel[cnps]  : total mass present in pelagic: g C: g N: g P: g Si

    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    # Diagnostic variables 
    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    Chla	:   Chlorophylla : mg Chl/m3

    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    # Water column diagnostic rates
    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

    flPTN6r     :   Pelagic anaerobic mineralization rate : mmol O2/m3/d
    flN3O4n	:   Pelagic denitrification rate :mmol N/m3/d
    flN4N3n	:   Pelagic nitrification rate   :mmol N/m3/d

    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    # Variables holding quota of elements in species
    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

    sunPI(PhytoPlankton)        : Specific Net Prod. PhytoPlankton : mgC/mgC/day

    qpPc(PhytoPlankton)		: Quotum p/c in PhytoPlankton : mmol P/mg C 
    qnPc(PhytoPlankton)		: Quotum n/c in PhytoPlankton : mmol N/mg C 
    qsPc(PhytoPlankton)		: Quotum si/c in PhytoPlankton : mmol Si/mg C 
    qlPc(PhytoPlankton)		: Quotum chl/c in PhytoPlankton : mg Chl /mg C

    qpZc(MesoZooPlankton)	: Quotum p/c MesoZooPlankton :mmol P/mg C 
    qnZc(MesoZooPlankton)	: Quotum n/c MesoZooPlankton :mmol N/mg C 

    qp_mz(MicroZooPlankton)	: Quotum p/c MicroZooPlankton :mmol P/mg C  
    qn_mz(MicroZooPlankton)	: Quotum n/c MicroZooPlankton :mmol N/mg C 

    qpR6c	: Quotum p/c in R6:mmol N/mg C 
    qnR6c	: Quotum n/c in R6:mmol P/mg C  
    qsR6c	: Quotum si/c in R6:mmol Si/mg C
 
    qpB1c	: Quotum p/c in B1 :mmol P/mg C  
    qnB1c	: Quotum n/c in B1 :mmol N/mg C  


   #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
   # Sinking rates of phytoplankton and detritus
   #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    sediPI(PhytoPlankton)     : PhytoPlankton sedimentation rate :m/d
    sediMiZ(MicroZooPlankton) : MicroZooPlankton sedimentation rate :m/d
    sediMeZ(MesoZooPlankton)  : MesoZooPlankton sedimentation rate :m/d
    sediR2                    : Detritus sedimentation rate:m/d
    sediR6                    : Detritus sedimentation rate:m/d

end

#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# Light Variables 
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
1d-variable
   SUNQ	 : Daylength in hours : h
   ThereIsLight   : Forcing for day/night
end

3d-variable
     eiPI(PhytoPlankton)  : Regulating factor for light in PhytoPlankton : -
     xEPS                 : Total extinction coefficient : 1/m
     EPLi(PhytoPlankton)  : Optimal light in PhytoPlankton : W/m2
     ABIO_eps             # the abiotic extinction coefficient calculated 
                          # in the sediment models (GOTM/GETM)
end
 
2d-state -if-exist INCLUDE_BEN
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Benthic State Vars
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    group BenOrganisms[cnp] :mg C/m2:mmol N/m2:mmol P/m2
		Y1 	: Epibenthos        
		Y2 	: Deposit feeders   
		Y3 	: Suspension feeders
		Y4 	: Meiobenthos       
		Y5	: Benthic predators 
    end

    Q6[cnps]    :Particulate organic carbon  :mg C/m2:mmol N/m2:mmol P/m2:mmolSi/m2 

    group BenDetritus[cnp] :mg C/m2:mmol N/m2:mmol P/m2
		Q1 	: Labile organic carbon
		Q11	: Labile organic carbon
    end

    group BenBacteria[cnp]:mg C/m2:mmol N/m2:mmol P/m2
		H1 			: Aerobic benthic bacteria
		H2			: Anaerobic benthic bacteria
    end


  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #	Benthic nutrient dynamics
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

    group BenthicPhosphate[p] :mmol P/m2
		K1 		: Phosphate in oxic layer
		K11 		: Phosphate in denitrification layer
		K21		: Phosphate in anoxic layer
    end

    group BenthicAmmonium[n] :mmol N/m2
		K4		: Ammonium in oxic layer
		K14		: Ammonium in denitrification layer
		K24		: Ammonium in anoxic layer
    end

    K3[n]	: Nitrate in sediments :  mmol N/m2
    K5[s]       : Silicate in sediments : mmol Si/m2
    K6[r]	: Reduction equivalents in oxic layer : mmolS--/m2
    K16[r]	: Reduction equivalents in denitrification layer : mmolS--/m2
    K26[r]	: Reduction equivalents in anoxic layer : mmolS--/m2
    G2[o]	: Benthic O2 : mmol O2/m2
    G4[n]	: N2 sink for benthic system. :mmol N/m2

    D1[m]	: Oxygen penetration depth 	:m
    D2[m]	: Denitrification depth		:m
    D6[m]	: Penetration Depth organic C	:m
    D7[m]	: Penetration Depth organic N   :m
    D8[m]	: Penetration Depth organic P 	:m
    D9[m]	: Penetration Depth organic Si  :m
end


2d-variable -if-exist INCLUDE_BEN

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Variables to check totmass of C N P Si in benthic
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  totben[cnps]  : total mass present in benthos: g C: g N: g P: g Si

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #	These variables are used as input to the Benthic Nutrient Model: 
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

  rrBTo	: Total Benthic oxic respiratio	: mmol O2/m2/d
  rrATo	: Total Benthic anoxic respiration : mmol O2/m2/d	
  reBT[np]	: Total Benthic oxic respiratio	:  mmol N/m2/d: mmol P/m2/d	
  reAT[np]	: Total Benthic anoxic respiration :  mmol N/m2/d	: mmol P/m2/d	

  ruHI(BenBacteria) : uptake of Q1/Q11 by BenBacteria :mg C/m2/d  
  reHI(BenBacteria) : excretion of Q1/Q11 BenBacteria :mg C/m2/d  

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Control of benthic organism on diagenetic processes
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  turenh	: Enhancement factor due to bioirrigation : -
  irrenh 	: Enhancement factor due to bioturbation  : -


  shiftD1m 	: Rate of change of D1m: m/d	
  shiftD2m 	: Rate of change of D2m: m/d	

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  #  Variables for exchange fluxes/info between processes in Benthic Nutrient Model 
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  jG2K3o	: Oxygen consumption by nitrification	 : mmol O2/m2/d	
  jG2K7o	: ReOxidation of Red.Equiv. in oxic layer: mmol O2/m2/d	

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Variables in the benthic nurient model which represent the concentration 
  # of the macro nutr. in the porewater of the different layers. 
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

    M1p		: phosphate in oxic layer (pore-waters):mmol P/m3
    M11p	: phosphate in denitrification layer (pore-waters):mmol P/m3
    M21p	: phosphate in anoxic layer (pore-waters):mmol P/m3
    M4n		: ammonium in oxic layer (pore-waters):mmol N/m3
    M14n	: ammonium in denitrification layer (pore-waters):mmol N/m3
    M24n	: ammonium in anoxic layer (pore-waters) :mmol N/m3
    M3n		: nitrate in porewater (pore-waters):mmol N/m3
    M5s		: silicate in oxic_denitrification layer (pore-waters):mmol Si/m3
    M6r		: reduction equivalent in porewater (pore-waters):mmol S--/m3
    
end

2d-intvar -if-exist INCLUDE_BEN
    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
    # Profile sequence numbers needed in benthic nutrient model
    #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
      KPO4	
      KPO4_2	
      KNH4
      KNO3
      KRED
      KSIO3
      KSIO3E
      KQ1
end

2d-variable -if-exist INCLUDE_BEN

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Variables for  exchange of info between Pelagic and benthic on
  # processes concerning food uptake/excretion of filterfeeders
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

  RI_F[cnps]  : Detritus Food for Filterfeeder : mg C/m3:mmol N /m3: mmol N/m3: mmol Si/m3
  ZI_F[cnps]  : Total phytoplankton Food: mg C/m3:mmol N /m3: mmol N/m3: mmol Si/m3
  jPIY3c(PhytoPlankton)       :phytoplankton filtered by filter feeders   : mg C/m2/d  
  jZIY3c       :microzooplnkton filtered by filter feeders : mg C/m2/d  
  jRIY3[cnps]  :detrtus filtered by filter feeders  : mg C/m2/d  : mmol N/m2/d : mmol P/m2/d: mmol Si/m2/d  

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Boundary conditions derived from pelagic model for benthic model  
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

  PI_Ben[cnps](PhytoPlankton) :PhytoForcing for Benthic System: mg C/m3:mmol N /m3: mmol N/m3: mmol Si/m3
  Depth_Ben  : depth of the  layer above sediment : m
  ETW_Ben    : temperature :C
  ERHO_Ben   : density: g/m3
  ESW_Ben   : salinity :psu
  O2o_Ben    : oxygen conc. in the pelagica :mmol O2/m3
  N1p_Ben    : phosphate conc. in the pelagic: mmol P/m3
  N3n_Ben    : nitrate conc. in the pelagic: mmol N/m3
  N4n_Ben    : ammonium conc. in the pelagic: mmol N/m3
  N5s_Ben    : silicate conc. in the pelagic: mmol Si/m3
  N6r_Ben    : red. equiv. conc. in the pelagic: mmol S--/m3
  sediR6_Ben                    : Detritus sedimentation rate:m/d
  sediPI_Ben(PhytoPlankton)     : PhytoPlankton sedimentation rate :m/d

  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Fluxes calculated in benthic nutrient model
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

  jK4K3n :   nitrification flux : mmol/m2/d 
  jK3G4n :   denitrification flux : mmol/m2/d 
  jK31K21p : flux of phosphate at lower benthic boundary : mmol/m2/d 
  jK34K24n : flux of ammonium at lower benthic boundary : mmol/m2/d 
  jK13K3n :  flux of nitrate at lower benthic boundary : mmol/m2/d 
  jK15K5s :  flux of silicate at lower benthic boundary : mmol/m2/d 
  jK36K26r :  flux of read. equivalent at lower benthic boundary : mmol S--/m2/d 

end

2d-variable 
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Variables to be used in budget calculations to check hidden sinks from 
  # state vars
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  jsdoMesoc     : auto moratlity loss (=grazing) of mesozooplankton : mg C/m2/d
  jrsMicroc     : rest respiration microzooplankton: mgC/m2/d
  jnetPTc: net primary production :mg C/m2/d
  jnetMeZc: net second. mesoz. prod.:mgC/m2/d
  jnetMiZc: net second. microz prod.:mgC/m2/d
  jnetB1c: net bact. produc.:mgC/m2/d
  jnetY3c: net filterfeeder produc.:mgC/m2/d
# jinPIc : vert. input of phyto in sedimentlayer: mgC/m2/d

end

3d-variable -if-exist INCLUDE_BENPROFILES -Z seddepth=0.30:Sediment Depth:m
    PrM1p : PO4--- in sediment: mmol/m3 pw 
    Pr2M1p : PO4--- in sediment: mmol/m3 pw 
    PrM3n : NO3- in sediment: mmol/m3 pw 
    PrM4n : NH4+ in sediment: mmol/m3 pw 
    PrM5s : SiO3-- in sediment: mmol/m3 pw 
    PrM6r : S-- in sediment: mmol/m3 pw 
    PrQ1c : Dissolved Org.Carbon: mgC/m3 pw
end

3d-variable -if-exist INCLUDE_BENCO2 INCLUDE_BENPROFILES -Z seddepth=0.30:Sediment Depth:m
    PrDIC : DIC in sediment: mgC/m3 pw 
    PrAc : Alkalinity in sediment: mmol/m3 pw 
    PrpH : Ph in sediment: -
end

2d-variable
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  # Variables to check total mass of C N P Si in the system
  #-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  totsysc  : total mass :  g C
  totsysn  : total mass :  g N
  totsysp  : total mass :  g P
  totsyss  : total mass :  g Si
end


#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# Diagnostic rates
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
3d-flux -if-exist INCLUDE_DIAG3D
  ruPTc=P.c <- O3c:gross primary production:mg C/m3/d
  ruPTn=P.n <- N3n+N4n: net nutrient uptake:mmoln /m3/d
  ruPTp=P.p <- N1p : net phosphate uptake : mmol P /m3/d
  exPP=(P.c->R1c+R2c+R6c): C excretion from phytoplankton :mg C/m3/d
  resPP=(P.c->O3c) : respiration phytoplankton :mg C/m3/d
  resZT=(Z.c->O3c) : respiration zooplankton :mg C/m3/d
  ruZTc=(Z.c<-P.c+B1c+Z.c): gross secondary production:mg C/m3/d
  netZTc=(Z.c<-P.c+B1c+Z.c)-(Z.c->R1c+R6c): net secondary production:mg C/m3/d
  rrPTo=(O2o->*): pelagic respiration : mmol O2/m3/d
  rePTn=(N3n+N4n<-B1n+Z.n): pelagic mineralization : mmol N/m3/d
  rePTp=(N1p<-B1p+Z.p): pelagic mineralization: mmol P /m3/d
  reBn=(N4n<-B1n): bacterial mineralization : mmol N/m3/d
  ruBn=(N4n->B1n): bacterial uptake : mmol N/m3/d
  fR2B1c=R2c->B1c: TEP uptake by bacteria: mg C/m3/d
  fP1Z4c=P1c->Z4c: diatom grazing by omniv.zooplankton: mg C/m3/d
end

3d-flux -if-exist INCLUDE_DIAG3D specific
  suPTc=P.c <- *:specific gross primary production: /d
end
		
3d-flux -if-exist INCLUDE_DIAG2D perm2
  grsPPm2=(P.c<- *):gross primary production:mg C/m2/d
  exPPm2=(P.c->R1c+R2c+R6c): excretion phytoplankton :mg C/m2/d
  resPPm2=(P.c->*) : respiration phytoplankton :mg C/m2/d
end


#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NAMELISTS
#-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! ROUTINE: CO2
!
! DESCRIPTION
!   List of parameters values
!
! INTERFACE
! parameter values for mem_CO2 filled by InitCO2
!
!
! AUTHORS
!   the BFM team
!
! COPYING
!   
!   Copyright (C) 2007 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC

&CO2_parameters
! Initial CO2 concentration in the air [ppm]
   AtmCO20 = 370.0E0
! Compute the partial pressure of Atmospheric CO2
   calcAtmpCO2 = .FALSE.
   pCO2Method = 1  ! 1=MixRatio*slp, 2=Magnus formula 
!-----------------------------------------------------------------------------------!
! Read external data for atmospheric CO2 values  
          ! Read  !   File   ! NetCDF  !  Var    !  RefTime   ! Input      !   Time   !
          ! Input !   name   ! Logical !  name   !  yyyymmdd  ! Frequency  !  interp  !
!AtmCO2_N =    2  , 'CMIP5_Historical_GHG_1765_2005.nc' , .TRUE.  , 'CO2'   , '1764-07-01 00:00' ,  'yearly'  ,  .TRUE.  
!AtmCO2_N =    2  , 'CMIP5_Historical_GHG_1765_2005.dat' , .FALSE.  , 'CO2'   , '1764-07-01 00:00' ,  'yearly'  ,  .TRUE.  
! Read external data for atmospheric SLP 
AtmSLP_N  =    0  , 'AtmSLP.nc' , .TRUE.  ,'AtmSLP' , '1764-07-01 00:00'  , 'dummy' ,  .TRUE.  
AtmTDP_N  =    0  , 'AtmTDP.nc' , .TRUE.  ,'AtmTDP' , '1764-07-01 00:00'  , 'dummy' ,  .TRUE.  
!-----------------------------------------------------------------------------------!

! Initial pH value
   phstart = 8.10E0

! Choice of the acidity constants parameterization
! K1K2==1 Roy et al. (1993); DOE (1994); pH on total scale
! K1K2==2 Default
!         Mehrbach et al (1973) refit by Dickson & Millero (1987)
!         OCMIP STANDARD; pH on Sea Water Scale
! K1K2==3 Mehrbach et al (1973) refit by Lueker et al. (2000)
!         pH on total scale
! K1K2==4 Hansson (1973b) data as refitted by Dickson and 
!         Millero (1987); pH on Sea Water Scale
   K1K2 = 2

! Choice of [H+] numerical computation
! MethodCalcCO2=1 Approximate static solution
! MethodCalcCO2=2 Default. Standard OCMIP iteration
! MethodCalcCO2=3 Follows et al., Ocean Modelling 2006
!
! Parameters for MethodCalcCO2=2
! M2XACC    :  accuracy of the iterative scheme for OCMIP (default 1.E-10)
! M2PHDELT  :  delta of pH for the root search (realized pH+/-DELT)
!              in the OCMIP scheme (default 0.5)
! M2MAXIT   :  maximum number of iterations for OCMIP (default 100 )
!
   MethodCalcCO2 = 2
          M2XACC = 1.0E-10
        M2PHDELT = 0.3
         M2MAXIT = 100
!
! Calcium ion concentration
!     [from : "Seawater : Its composition, properties and behaviour"
!      (2nd Edition), Open University Course Team, 1995]
!     seawater concentration    = 412 mg / l
!     atomic weight             = 40.078 g / mol
!     therefore, concentration  = 10.279 mmol / l
!                               = 10.279 mol / m3
        Caconc0 = 10.279E0
! Normalize Calcium ion concentration by sea water salinity
        Canorm  = .TRUE.
	filename_nml_conf = 'CO2.nml',
/

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! !ROUTINE: LightAdaptation
!
! DESCRIPTION
!   List of parameters values
!   for mem_LightAdaptation filled by InitLightAdaptation
!
! AUTHORS
!   the BFM team
!
! COPYING
!   
!   Copyright (C) 2006 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
!
!  p_isw:  	 Switch between parameterizations
!  p_chEPLi:  	 Maximum Iopt (W/m2)
!        :  	    p_clEPLi    =      4.0,    6.0,    5.0,    8.0	# Minimum Iopt (W/m2)
!  p_clEPLi:  	 Minimum Iopt (W/m2)
!        :  	    p_ruEPLi    =      0.25,    0.25,   0.5,    0.125	# Maximum daily shift in Iopt (1/d)
!  p_ruEPLi:  	 Maximum daily shift in Iopt (1/d)
!  p_addepth:  	 Adaptation depth. Meaningless with high-res models

&LightAdaptation_parameters
      p_isw = 	1,	1,	1,	1
  p_addepth = 	50.0,	50.0,	50.0,	50.0
  p_chEPLi  = 	100.0,	100.0,	100.0,	100.0
  p_clEPLi  = 	8.0,	10.0,	6.0,	12.0
  p_ruEPLi  = 	0.2,	0.25,	0.3,	0.15
	filename_nml_conf = 'LightAdaptation.nml',
/
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! !ROUTINE: MesoZoo
!
! DESCRIPTION
!   List of parameters values
!   for mem_MesoZoo filled by InitMesoZoo
!
! AUTHORS
!   the BFM team
!
! COPYING
!   Copyright (C) 2006 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
!
!        :
!        :  	 The variable Z3 represents carnivorous mesozooplankton and Z4 represents
!        :  	 omnivorous mesozooplankton.
!        :
!  p_q10:  	 Doubling temperature
!  p_srs:  	 Respiration rate at 10 degrees C
!  p_sum:  	 Maximal productivity at 10 degrees C
!  p_sd:  	 Background natural mortality
!  p_vum:  	 Specific search volume
!  p_puI_u:  	 Assimilation efficiency
!  p_peI_R6:  	 Faeces production
!  p_sdo:  	 Fractional density-dependent mortality
!  p_sds:  	 Exponent of density-dependent mortality
!  p_qpc:  	 Quotum phosphate
!  p_qnc:  	 Quotum nitrate

&MesoZoo_parameters
!		Z3	Z4
       p_q10 =	2.0,	2.0
       p_srs =	0.01,	0.02
        p_sd = 	0.01,	0.01
       p_sum = 	1.6,	2.0
       p_vum = 	0.016,	0.008
     p_puI_u = 	0.8,	0.6
    p_peI_R6 = 	0.2,	0.4
       p_sdo = 	4.d-4,	4.d-4
       p_sds = 	2.0,	2.0
       p_qpc = 	1.67d-3,1.67d-3
       p_qnc = 	0.015,	0.015
     p_clO2o = 	30.0,	30.0
!		P1	P2	P3	P4
!	Z3
 p_puPI(1,:) =	0.0,	0.0,	0.0,	0.0
!	Z4
 p_puPI(2,:) =	1.0,	0.25,	0.0,	0.0
!		Z5	Z6
!	Z3
p_puMIZ(1,:) =	0.0,	0.0
!	Z4
p_puMIZ(2,:)=	1.0,	0.0,
!		Z3	Z4
!	Z3
p_puMEZ(1,:)=	1.0,	1.0
!	Z4
p_puMEZ(2,:)=	0.0,	1.0

	filename_nml_conf = 'MesoZoo.nml',
/
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! !ROUTINE: MicroZoo
!
! DESCRIPTION
!   List of parameters values
!   for mem_MicroZoo filled by InitMicroZoo
!
! AUTHORS
!   the BFM team
!
! COPYING
!   
!   Copyright (C) 2006 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
!
!        :
!        :  	 The variable Z5 represents microozooplankton and Z6 represents
!        :  	 heterotrophic nanoflagellates (HNAN)
!        :
!  p_q10:  	 Q10 value
!  p_srs:  	 Respiration rate at 10 degrees Celsius
!  p_sum:  	 Max. rel daily uptake as a fraction of biomass
!  p_sdo:  	 Mortality due to oxygen limitation
!  p_sd:  	 Temperature independent mortality
!  p_pu:  	 Assimilation efficiency
!  p_pu_ea:  	 Activity excretion
!  p_chro:  	 Oxygen saturation where respiration is 0.5
!  p_chuc:  	 Food concentration where total uptake rate is 0.5
!  p_minfood:  	 Concentration below which feeding on a particular
!        :  	 foodsource is depressed
!  p_qn_mz:  	 Maximum quotum P
!  p_qp_mz:  	 Maximum quotum N
!  p_suPI(P1):  	 /day   #relative P1 uptake by zoo
!  p_suPI(P2):  	 /day   #relative P2 uptake by zoo
!  p_suPI(P3):  	 /day   #relative P3 uptake by zoo
!  p_suPI(P4):  	 /day   #relative P4 uptake by zoo
!  p_suZI(Z5):  	 /day   #relative Z5 uptake by zoo
!  p_suZI(Z6):  	 /day   #relative Z6 uptake by zoo
!  p_suB1:  	 /day   #relative B1 uptake by zoo

!       	Z5	Z6
&MicroZoo_parameters
       p_q10 = 	2.0,	2.0
       p_srs = 	0.02,	0.02
       p_sum = 	2.0,	10.0
       p_sdo = 	0.05,	0.05
        p_sd = 	0.0,	0.0
        p_pu = 	0.6,	0.5
     p_pu_ea = 	0.25,	0.35
      p_chro = 	7.8,	7.8
      p_chuc = 	30.0,	100.0
   p_minfood = 	10.0,	50.0
     p_qp_mz = 	1.85d-3,1.85d-3
     p_qn_mz = 	1.67d-2,1.67d-2
! Food matrix parameters: take care of the notation
!		P1	P2	P3	P4
!	Z5
 p_suPI(1,:) =	0.0,	1.0,	0.1,	0.0
!	Z6
 p_suPI(2,:) =	0.0,	0.2,	1.0,	0.0
!		Z5	Z6
!	Z5
 p_suZI(1,:) = 	1.0,	1.0
!	Z6
 p_suZI(2,:) = 	0.0,	0.2
!		Z5	Z6
      p_suB1 = 	0.1,	1.0
	filename_nml_conf = 'MicroZoo.nml',
/
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! !ROUTINE: Param
!
! DESCRIPTION
!   List of parameters values
!   for mem_Param filled by InitParam
!
! AUTHORS
!   the BFM team
!
! COPYING
!   
!   Copyright (C) 2006 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
&Param_parameters
                    p_small = 1.0e-20
                  p_q10diff = 1.49
                      p_qro = 0.5
               p_qon_dentri = 1.25
                p_qon_nitri = 2.0
                    p_clDxm = 0.001
       CalcConservationFlag = .FALSE.
          CalcTransportFlag = .TRUE.
            CalcPelagicFlag = .TRUE.
            CalcBenthicFlag = 0
                    p_poro0 = 0.7 
       CalcPhytoPlankton(1) = .TRUE.
       CalcPhytoPlankton(2) = .TRUE.
       CalcPhytoPlankton(3) = .TRUE.
       CalcPhytoPlankton(4) = .FALSE.
               CalcBacteria = .TRUE.
     CalcMesoZooPlankton(1) = .TRUE.
     CalcMesoZooPlankton(2) = .TRUE.
    CalcMicroZooPlankton(1) = .TRUE.
    CalcMicroZooPlankton(2) = .TRUE.
           CalcPelChemistry = .TRUE.
AssignPelBenFluxesInBFMFlag = .TRUE.
AssignAirPelFluxesInBFMFlag = .TRUE.
                      p_PAR = 0.40
                       slp0 = 1013.25E0
               ChlLightFlag = 2
           ChlSynthesisFlag = 1
        ProductionLightFlag = 1
          LightLocationFlag = 3
                     p_eps0 = 0.0435
                   p_epsESS = 0.04d-3
                 p_InitSink = 100.0
                    p_d_tot = 0.30
                  p_d_tot_2 = 0.35
                  p_clD1D2m = 0.01
                   p_pe_R1c = 0.60
                   p_pe_R1n = 0.72
                   p_pe_R1p = 0.832
                   p_pe_R1s = 0.06
                    p_epsR6 = 0.1d-3
          check_fixed_quota = 0
	filename_nml_conf = 'Param.nml',
/
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!  p_q10diff:  	 Temperature-dependency porewater diffusion
!  p_qro:  	 stoichiometry O2-->S2-
!  p_qon_dentri:  	 stoichiometry O2-->N denitrification
!  p_qon_nitri:  	 stoichiometry O2-->N nitrification
!  p_clDxm:  	 minimal value of D?.m for calculation of the alpha
!        :  	 alpha is used in expo.func and values > 1/0.001 leadt
!  CalcPelagicFlag:  	 Switch for pelagic system
!  CalcBenthicFlag:  	 Switch for benthic system
!  CalcTransportFlag:    Switch for transport
!  CalcConservationFlag:    Switch for mass conservation check
!  CalcPhytoPlankton:  	 Switches to turn on/off the calculation of pelagic groups
!  CalcBacteria:
!  CalcMesoZooPlankton:
!  CalcMicroZooPlankton:
!  CalcPelChemistry:
!  CalcBenOrganisms:  	 Switches to turn on/off the calculation of benthic organisms
!  CalcBenBacteria:
!  AssignPelBenFluxesInBFMFlag:  	 Switches to make choice to define boundary
!  AssignAirPelFluxesInBFMFlag:  	 fluxes in physical of biological model
!        :  	     dim2D%
!  p_PAR:  	 Photosynthetically available radiation
!  ChlLightFlag:  	 Switch between light prop.(=1) or Chla.(=2) as a state
!  ChlSynthesisFlag:  	 Switch between types of chl synthesis
!                        1. PELAGOS; 2. OPATM-BFM; 3. UNIBO
!  ProductionLightFlag:  Switch between instantaneous light production (=1) 
!                        and daylength averaged production (=2)
!  LightLocationFlag:    Switch between different depth-parameterizations
!  p_eps0:  	 Background extinction (abiotic)
!  p_epsESS:  	 Inorg. suspended matter extinction coeff. (abiotic)
!  p_InitSink:   parameter to Initialize BenthicSInk var.
!  p_d_tot:  	 m # Max Thickness of the denitrification layer
!  p_d_tot_2:  	 m # Thickness of modelled benthic sediment layers
!  p_clD1D2m:  	 m # minimum distancebetween D1m and D2m
!  p_pe_R1c:  	 Fraction of excretion going to PLOC
!  p_pe_R1n:  	 Fraction of excretion going to PLOC
!  p_pe_R1p:  	 Fraction of excretion going to PLOC
!  p_epsR6:  	 (m2/mgC) # Detritus-contribution to extinction
!  check_fixed_quota       Check whether zooplankton have fixed quota
!  p_poro0:      Constant porosity for 0D and 1D runs

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! !ROUTINE: PelBac
!
! DESCRIPTION
!   List of parameters values
!
! !AUTHORS
!   the BFM team
!
! COPYING
!   
!   Copyright (C) 2008 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
!
!  p_version:  	 Switch for DOM uptake parameterization
!        :  	 p_version=1 Polimene et al., 2006
!        :  	 p_version=2 <BFM> standard version
!  p_q10:  	 Q10-value (temperature dependency)
!  p_chdo:  	 Michaelis const for O2 dependence (mmol/m3)
!  p_sd:  	 Independent specific mortality (1/d)
!  p_sd2:  	 Density dependent mortality (value: 0.009) (1/d)
!  p_suR1:  	 Specific potential DOM availability (1/d)
!  p_suR2:  	 Specific potential DOM availability (1/d)
!  p_suR6:  	 Availability of POM (1/d)
!  p_sum:  	 Specific potential uptake (1/d)
!  p_pu_ra:  	 Activity respiration (-)
!  p_pu_ra_o:  	 Decrease in Ass. efficiency at low O2 conc (-).
!  p_srs:  	 Specific rest respiration (1/day)
!  p_qnc:  	 Optimal N/C ratio (model units) 45:9:1
!  p_qpc:  	 Optimal P/C ratio (model units) C:N:P
!  p_qlnc:  	 Minimal N/C ratio (model units) 45:9:1 <BFM>
!  p_qlpc:  	 Minimal P/C ratio (model units) C:N:P (BFM>
!  p_qun:  	 nutrient affinity ( mmol/mgC/day) <BFM>
!  p_qup:  	 nutrient affinity ( mmol/mgC/day) <BFM>
!  p_lN4:  	 ammonium conc. at which nutrate uptake are equal (BFM)
!  p_pu_ea_R7:   excretion of reg. org. met. (-) <POLIMENE>

&PelBac_parameters
  p_version = 2
      p_q10 = 2.95
     p_chdo = 30.0
       p_sd = 0.0
      p_sd2 = 0.009
    p_suhR1 = 0.5
    p_sulR1 = 0.25
     p_suR2 = 0.05
     p_suR6 = 0.02
      p_sum = 8.4
    p_pu_ra = 0.6
  p_pu_ra_o = 0.2
 p_pu_ea_R7 = 0.015
      p_srs = 0.01
      p_qpc = 1.9d-3
    p_qlpc  = 9.5d-4
      p_qnc = 1.2d-2
     p_qlnc = 6.0d-3
      p_qun = 0.050
      p_qup = 0.0050,
      p_lN4 = 0.05
	filename_nml_conf = 'PelBac.nml',
/
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!EOP
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! !ROUTINE: PelChem
!
! DESCRIPTION
!   List of parameter values for peagic chemistry
!
! AUTHORS
!   the BFM team
!
! COPYING
!   
!   Copyright (C) 2006 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
&PelChem_parameters
    p_sN4N3 = 0.01
  p_q10N4N3 = 2.367
  p_q10R6N5 = 1.49
      p_rOS = 0.05
    p_clO2o = 10.0
    p_clN6r = 1.0
   p_sN3O4n = 0.35
     p_rPAo = 1.0
    p_sR6N5 = 0.02
	filename_nml_conf = 'PelChem.nml',
/
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! ROUTINE: PelGlobal
!
! DESCRIPTION
!   List of parameters values
!   for mem_PelGlobal filled by InitPelGlobal
!
! AUTHORS
!   the BFM team
!
! COPYING
!   
!   Copyright (C) 2006 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
!
!  p_rR6m:  	 m/d   # detritus sinking rate
!  p_rPIm:  	 m/d   # phytoplankton background sinking rate

&PelGlobal_parameters
  p_rR6m = 1.5
!		P1	P2	P3	P4
  p_rPIm = 	0.0, 	0.0, 	0.0, 	0.0
	filename_nml_conf = 'PelGlobal.nml',
/
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! !ROUTINE: PhotoAvailableRadiation
!
! DESCRIPTION
!   List of parameters values
!   for mem_PhotoAvailableRadiation filled by InitPhotoAvailableRadiation
!
! AUTHORS
!   the BFM team
!
! COPYING
!   
!   Copyright (C) 2006 P. Ruardij, the mfstep group, the ERSEM team 
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
!
!  p_iswLtyp:  	 Shape of the productivity function

&PAR_parameters
!		P1	P2	P3	P4
  p_iswLtyp = 	5,	5,	5,	5
	filename_nml_conf = 'PhotoAvailableRadiation.nml',
/
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! !ROUTINE: Phyto
!
! DESCRIPTION
!   List of parameter values
!   for mem_Phyto filled by InitPhyto
!
! AUTHORS
!   the BFM team
!
! COPYING
!   Copyright (C) 2008 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!        :
!        :  	 ---------------- Physiological parameters -----------------
!        :
!  p_q10:  	 Doubling temperature
!  p_sum:  	 Maximal productivity at 10 degrees C
!  p_srs:  	 Respiration rate at 10 degrees C
!  p_sdmo:  	 Max.specific nutrient-stress lysis rate
!  p_thdo:  	 Half value for nutrient stress lysis
!  p_seo:  	 Extra lysis rate for high density cells
!  p_sheo:  	 Half value for density stress lysis
!  p_pu_ea:  	 Fraction of pp excreted as PLOC/PDET
!  p_pu_ra:  	 Activity respiration rate
!        
!         	 ---------------- Nutrient parameters in phytoplankton -----------------
!       
!  p_netgrowth:  logical switch for nutrient-limited growth (true is default)
!  p_limnut:  	 switch for nut. limitation (Liebig is default)
!  p_chPs:  	 half-value of SIO4-lim (mmol Si m-3)
!  p_qslc:  	 Minimum quotum Si in PI
!  p_qsRc:  	 Reference quotum Si in PI
!  p_qus:  	 affinity of PI for Si
!  p_alpha_chl:  	 Initial slope P-I curve
!      
!       	 ------------- Chlorophyll parameters -----------
!       	 skel: Skeletonema costatum pav: Pavlova lutheri
!       	 syn: Synechoccus sp. (significant alpha decrease with irradiance)
!       	 gyr: Gyrodinium sp. iso: Isochrysis galbana
!       	             skel     iso      syn      gyr
!  p_sdchl:  	 Specific turnover rate for Chla (d-1)
!       	p_qchlc =    0.03,    0.025,   0.1,     0.02    # Maximum quotum Chla:C
!       	            +-0.024  +-0.001  +-0.003  +-0.004
!       	 Thalassiosira sp. (0.05+-0.01)
!       	             skel     pav      syn      gyr
!  p_esNI:  	 Nutrient stress threshold for Sinking
!       	p_alpha_chl = 1.0d-5, 0.46d-5*2.0, 2.0d-5, 0.68d-5 # Initial slope P-I curve
!       	 Thalassiosira sp. (0.48-0.63)
!  p_res:  	Maximum Sinking velocity (m/d)
!  p_qchlc  = 0.05,      0.03,      0.07,      0.02 # Maximum quotum Chla:C
!  p_epsChla:  	 Chla-contribution to extinction
!       	 ------------- silicate limitation control: -----------
!             p_qus > 0.0  : silica limitation is controlled by internal quoata
!             if p_qus\=0  : simple MM limitation on external concentration
!                            p_chPs must have a number or an error is generated!
!                ------------- Iron parameters -----------
!                conc.=[umol/m3] ratio=[umol Fe/mg C]
!  p_qflc:       min Fe:C ratio derived from 3 umol Fe/mol C
!                Sunda & Huntsman (1997), Nature, 390, p 389-392

!               P1	P2	P3	P4
&Phyto_parameters
     p_limnut = 1,	1,	1,	1
  p_netgrowth = .FALSE.,.FALSE.,.FALSE.,.FALSE.
        p_q10 = 2.0,	2.0,	2.0,	2.0
        p_sum = 2.0,	2.5,	3.0,	0.5
        p_srs = 0.01,	0.05,	0.1,	0.1
       p_sdmo = 0.05,	0.05,	0.05,	0.0
        p_seo = 0.0,	0.0,	0.0,	0.0
       p_sheo = 0.0,	0.0,	0.0,	100.0
      p_pu_ea = 0.05,	0.2,	0.2,	0.15
      p_pu_ra = 0.1,	0.2,	0.25,	0.1
 p_switchR1R2 = 1.0,	1.0,	1.0,    1.0
       p_qnlc = 4.193e-3,4.193e-3,4.193e-3,0.00687
       p_qnRc = 1.26e-2,1.26e-2,1.26e-2,1.26e-2
        p_xqn = 2.0,	2.0,	2.0,	2.0
       p_qplc = 1.80e-4,1.80e-4,1.80e-4,4.29e-4
       p_qpRc = 7.86e-4,7.86e-4,7.86e-4,7.86e-4
        p_xqp = 2.0,	2.0,	2.0,	2.0
       p_qslc = 8.5e-3,	0.0,	0.0,	0.0
       p_qsRc = 0.01,	0.0,	0.0,	0.0
        p_qun = 0.025,	0.025,	0.025,	0.025
        p_qup = 0.025,	0.025,	0.025,	0.025
        p_qus = 0.0,	0.0,	0.0,	0.0
       p_esNI = 0.1,	0.00,	0.00,	0.00
       p_thdo = 0.1,	0.1,	0.1,	0.1
       p_res  = 5.0,	0.0,	0.0,	0.0
       p_lN4  = 1.0,	1.0,	0.0,	1.0
       p_chPs = 1.0,	0.0,	0.0,	0.0
    p_Contois = 0.0,    0.0,    0.0,    0.0
  p_alpha_chl = 1.38e-5, 0.46e-5, 1.52e-5, 0.68e-5
      p_sdchl = 0.2,	0.2,	0.2,	0.2
    p_EpEk_or = 0.0,    0.0,    0.0,    0.0
 p_tochl_relt = 0.0,    0.0,    0.0,    0.0
      p_qchlc = 0.05,   0.03,   0.07,   0.02
    p_epsChla = 0.03,   0.03,   0.03,   0.03
	filename_nml_conf = 'Phyto.nml',
/

!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! ROUTINE: Settling
!
! DESCRIPTION
!   List of parameters values
!   for mem_Settling filled by InitSettling
!
! AUTHORS
!   the BFM team
!
!   Copyright (C) 2006 P. Ruardij, M. Vichi
!   (rua@nioz.nl, vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC
!
!
!  p_burvel_R6:  	 Bottom Burial Velocity for detritus (m/d)
!  p_burvel_R2:  	 Bottom Burial Velocity for dissolved (m/d)
!  p_burvel_PI:  	 Bottom Burial Velocity for plankton (m/d)

&Settling_parameters
  p_burvel_R6 = 1.5,
  p_burvel_R2 = 0.0,
  p_burvel_PI = 0.0
	filename_nml_conf = 'Settling.nml',
/

!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!END namelist
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

!BOP
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model 
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
!BOP
!
! ROUTINE: Namelist for standalone
!
! DESCRIPTION
!  Parameter values for module standalone filled by init_standalone
!
! AUTHORS
!   Marcello Vichi and Piet Ruardij
!
! COPYING
!   
!   Copyright (C) 2008 M. Vichi and P. Ruardij
!   (rua@nioz.nl; vichi@bo.ingv.it)
!
!   This program is free software; you can redistribute it and/or modify
!   it under the terms of the GNU General Public License as published by
!   the Free Software Foundation;
!   This program is distributed in the hope that it will be useful,
!   but WITHOUT ANY WARRANTY; without even the implied warranty of
!   MERCHANTEABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!   GNU General Public License for more details.
!
!EOP
!-------------------------------------------------------------------------!
!BOC

!-------------------------------------------------------------------------!
!NAMELIST bfm_nml
!-------------------------------------------------------------------------!
!Main initialisation and output specifications
!NAME           KIND    DESCRIPTION
!bio_calc 	logical	Switch on/off BFM (for coupled configurations)
!bfm_init       integer Initialization state
!                       0. from constant values in bfm_init_nml below
!                       1. from restart
!bio_setup	integer BFM configuration:
!			1. pelagic
!			2. benthic
!			3. pelagic and benthic
!out_fname 	string 	Name of NetCDF output file
!out_dir 	string 	Path to the output file
!out_title 	string 	Name of the experiment in NetCDF file
!out_delta 	integer Output is saved every out_delta timesteps
!-------------------------------------------------------------------------!
&bfm_nml
    bio_calc = .true.
    bfm_init = 0
   bio_setup = 1
  bfm_rstctl = .FALSE.
   out_fname = 'BFM_NEMO'
     out_dir = '.'
   out_title = 'BFM'
   out_delta = 12 
   parallel_log = .TRUE.
	filename_nml_conf = 'bfm.nml',
/

!-------------------------------------------------------------------------!
!NAMELIST bfm_init_nml
!-------------------------------------------------------------------------!
!Pelagic initialisation
! pelagic  (O)              O2:   Oxygen (mmol/m3)
! pelagic  (P)              N1:   Phosphate (mmol/m3)
! pelagic  (N)              N3:   Nitrate (mmol/m3)
! pelagic  (N)              N4:   Ammonium (mmol/m3)
! pelagic  (Si)             N5:   Silicate (mmol/m3)
! pelagic  (R)              N6:   Reduction Equivalents (mmol/m3)
! pelagic  (N)              O4:   N2-sink (mmol/m3)
! pelagic  (CNP)            B1:   Pelagic Bacteria
! pelagic  (CNPSiI)         P1:   Diatoms (group PhytoPlankton))
! pelagic  (CNPSiI)         P2:   Flagellates (group PhytoPlankton))
! pelagic  (CNPSiI)         P3:   PicoPhytoPlankton (group PhytoPlankton))
! pelagic  (CNPSiI)         P4:   Dinoflagellates (group PhytoPlankton))
! pelagic  (CNP)            Z3:   Carnivorous mesozooplankton (group MesoZooPlankton))
! pelagic  (CNP)            Z4:   Omnivorous mesozooplankton (group MesoZooPlankton))
! pelagic  (CNP)            Z5:   Microzooplankton (group MicroZooPlankton))
! pelagic  (CNP)            Z6:   Heterotrophic nanoflagellates (HNAN) (group MicroZooPlankton))
! pelagic  (CNPSi)          R1:   Labile Organic Carbon (LOC)
! pelagic  (C)              R2:   CarboHydrates (sugars)
! pelagic  (CNPSi)          R6:   Particulate Organic Carbon (POC)
! pelagic  (C)              R7:   Refractory Disoolved Organic Carbon
!<variablename>0 = <realvalue>
! 
! Initialization with InitVar structure
! BFM variable information for data input
! availabel fields:
! integer init: select the initialization
!               0 = homogeneous
!               1 = analytical
!               2 = from file
! options for init==1
! real anv1: value in the surface layer
! real anz1: depth of the surface layer
! real anv2: value in the bottom layer
! real anz2: depth of the bottom layer
! options for init==2 (not used when coupled with NEMO because 
!                      overridden by values in namelist_top)
! char filename: name of the input file
! char  varname: name of the var in input file
! Options currently used when coupled with NEMO
! logical obc: variable has open boundary data
! logical sbc: variable has surface boundary data
! logical cbc: variable has coastal boundary data
!-------------------------------------------------------------------------!
&bfm_init_nml
   N1p0 = 1.0,
   N3n0 = 5.0,
   N4n0 = 1.0,
   N5s0 = 8.0,
   N6r0 = 1.0,
   O2o0 = 300.0,
   O4n0 = 200.0,
   P1c0 = 1.0,
   P2c0 = 1.0,
   P3c0 = 1.0,
   P4c0 = 1.0,
   Z3c0 = 1.0,
   Z4c0 = 1.0,
   Z5c0 = 1.0,
   Z6c0 = 1.0,
   B1c0 = 1.0,
   R1c0 = 1.0,
   R2c0 = 0.1,
   R6c0 = 1.0,
   R7c0 = 1.0,
   O3c0 = 27060.00, ![mgC /m3]  2200 umol/Kg
   O3h0 = 2660.0,   ![mmol eq/m3]  2600 umol/Kg
	filename_nml_conf = 'bfm.nml',
/

!-------------------------------------------------------------------------!
!NAMELIST bfm_save_nml
!-------------------------------------------------------------------------!
!Stored variables
!ave_save: average values over the output interval
!var_save: instantaneous value at the output interval
!-------------------------------------------------------------------------!
&bfm_save_nml
   ave_save = 'ETW','O2o','O3c','O3h',
          'EIR',
          'N1p',
          'N3n',
          'N4n',
          'N5s',
          'P1c',
          'P2c',
          'P3c',
          'P4c',
          'R1c',
          'R2c',
          'R6c',
          'P1n',
          'P2n',
          'P3n',
          'P4n',
          'R1n',
          'R6n',
          'P1l',
          'P2l',
          'P3l',
          'P4l',
          'xEPS',
          'Chla',
          'eiPI(iiP1)',
          'eiPI(iiP2)',
          'eiPI(iiP3)',
          'eiPI(iiP4)',
          'qlPc(iiP1)',
          'qlPc(iiP2)',
          'qlPc(iiP3)',
          'qlPc(iiP4)',
          'qnPc(iiP1)',
          'qnPc(iiP2)',
          'qnPc(iiP3)',
          'qnPc(iiP4)',
          'qpPc(iiP1)',
          'qpPc(iiP2)',
          'qpPc(iiP3)',
          'qpPc(iiP4)',
	'sunPI(iiP1)','sunPI(iiP2)','sunPI(iiP3)','sunPI(iiP4)',
	filename_nml_conf = 'bfm.nml',
/

!EOC
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
! MODEL  BFM - Biogeochemical Flux Model
!-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
